<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="format-detection" content="telephone=no">

<title>箕谷SC 動画共有システム</title>
<link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700&display=swap" rel="stylesheet">
<link rel="manifest" href="manifest.json" />
<link rel="stylesheet" href="styles.css" />
</head>
<body>

<main class="container">
  <header class="header card">
    <h1 id="title">⚽️箕谷SC 動画共有システム⚽️</h1>
  </header>

  <!-- ▼ チーム参加 / ログイン -->
  <section class="section-card" id="teamSection">
    <div class="team-title-row">
      <h2 class="page-title">チーム参加 / ログイン</h2>
      <img src="minotani-logo.png" class="team-logo" alt="minotani logo">
    </div>
    <div class="row">
      <input id="teamNameInput" placeholder="チーム名（例：箕谷SC）" />
    </div>
    <div class="row">
      <input id="inviteCodeInput" placeholder="招待コード" />
    </div>
    <div class="row">
      <button id="btnJoin" class="btn primary">参加 / 作成</button>
    </div>
    <p class="muted small">招待コードを使ってチーム共有できます。完全無料の YouTube 限定公開方式です。</p>
  </section>

  <!-- ▼ YouTube動画追加 -->
  <section class="section-card" id="addVideoSection" style="display:none;">
    <h2>YouTube動画追加</h2>
    <div class="row">
      <input id="youtubeUrl" placeholder="YouTube の共有URL（例 https://youtu.be/xxxxx）" />
      <button id="btnAddYouTube" class="btn primary">追加</button>
    </div>
    <p class="muted small">動画は YouTube に限定公開でアップロードして共有してください。</p>
  </section>

  <!-- ▼ 試合作成 -->
  <section class="section-card" id="createMatchSection" style="display:none;">
    <h2>試合結果作成</h2>

    <div class="row vertical">
      <label class="lbl">試合種別</label>
      <select id="matchTypeCreate">
        <option value="">種別を選択</option>
        <option value="公式戦">公式戦</option>
        <option value="カップ戦">カップ戦</option>
        <option value="交流戦">交流戦</option>
      </select>
    </div>

    <div class="row vertical date-wrapper">
      <label class="lbl" for="matchDate">試合日</label>
      <div class="date-input-wrapper">
        <input id="matchDate" type="date" required />
        <span class="placeholder-text">日付を選択</span>
      </div>
    </div>

    <div class="row vertical">
      <label class="lbl">対戦相手</label>
      <input id="opponent" placeholder="例：○○SC" />
    </div>

    <div class="row vertical">
      <label class="lbl">会場</label>
      <input id="place" placeholder="例：しあわせの村　球技場" />
    </div>

    <div class="row vertical">
      <label class="lbl">得点</label>
      <div class="row">
        <input id="scoreA" type="number" min="0" placeholder="自チーム得点" />
        <input id="scoreB" type="number" min="0" placeholder="相手チーム得点" />
      </div>
    </div>

    <div class="row vertical">
      <label class="lbl">PK（任意）</label>
      <div class="row">
        <input id="pkA" type="number" min="0" placeholder="自チームPK得点" />
        <input id="pkB" type="number" min="0" placeholder="相手PK得点" />
      </div>
      <p class="muted small">同点でPK決着時のみ入力してください</p>
    </div>

    <div class="row vertical">
      <label class="lbl">紐づけ動画</label>
      <select id="videoSelect"></select>
      <button id="btnCreateMatch" class="btn" style="margin-top:6px;">作成</button>
    </div>
    <p class="muted small">作成後に試合結果一覧で編集できます。</p>
  </section>

  <!-- ▼ 試合結果一覧 -->
  <section class="section-card" id="scoresSection" style="display:none;">
    <h2>試合結果一覧</h2>
    <div id="scoreGroups"></div>
  </section>

  <!-- ▼ ログイン画面に戻る -->
  <div style="margin-top:18px; text-align:center;">
    <button id="btnBackLogin" class="btn" style="background:#888; width:90%;">ログイン画面に戻る</button>
  </div>

  <footer class="card small muted">
    © 箕谷SC 動画共有システム — YouTube限定公開方式（完全無料）
  </footer>
</main>

<!-- ▼ 編集モーダル -->
<div id="editModal" class="modal hidden">
  <div class="modal-content section-card">
    <h2>試合編集</h2>

    <div class="row vertical">
      <label class="lbl">試合種別</label>
      <select id="matchType">
        <option value="">選択してください</option>
        <option value="公式戦">公式戦</option>
        <option value="カップ戦">カップ戦</option>
        <option value="交流戦">交流戦</option>
      </select>
    </div>

    <div class="row vertical">
      <label class="lbl">試合日</label>
      <input type="date" id="edit-date">
    </div>

    <div class="row vertical">
      <label class="lbl">対戦相手</label>
      <input type="text" id="edit-opponent">
    </div>

    <div class="row vertical">
      <label class="lbl">会場</label>
      <input type="text" id="edit-place">
    </div>

    <div class="row vertical">
      <label class="lbl">自チーム得点</label>
      <input type="number" id="edit-my-score">
    </div>

    <div class="row vertical">
      <label class="lbl">相手チーム得点</label>
      <input type="number" id="edit-opponent-score">
    </div>

    <div class="row vertical">
      <label class="lbl">PK（任意）</label>
      <div class="row">
        <input id="edit-pkA" type="number" placeholder="自PK" />
        <input id="edit-pkB" type="number" placeholder="相手PK" />
      </div>
    </div>

    <div class="row vertical">
      <label class="lbl">紐づけ動画</label>
      <select id="edit-video-select"></select>
    </div>

    <div class="row vertical">
      <label class="lbl">自チームゴール秒数</label>
      <div class="row">
        <input id="hlSeconds" type="number" placeholder="例：85" />
        <button id="btnMarkGoal" class="btn">追加</button>
      </div>
      <div id="hlList" class="muted small" style="margin-top:8px;"></div>
    </div>

    <div class="row" style="margin-top:12px;">
      <button id="saveEdit" class="save-btn" style="flex:1;">保存</button>
    </div>
    <div class="row" style="margin-top:8px;">
      <button id="deleteMatch" class="delete-btn" style="flex:1;">この試合を削除</button>
    </div>
    <div class="row" style="margin-top:8px;">
      <button id="modalClose" class="close-btn" style="flex:1;">閉じる</button>
    </div>
  </div>
</div>

<!-- ▼ Firebase 初期化 -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getFirestore, collection, addDoc, setDoc, doc, getDocs, getDoc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDMJfAd5BffteapT51ZUO06VP-XDReFSwY",
  authDomain: "minotani-sc-app.firebaseapp.com",
  projectId: "minotani-sc-app",
  storageBucket: "minotani-sc-app.firebasestorage.app",
  messagingSenderId: "757066295000",
  appId: "1:757066295000:web:1c7a90f968af75d26099ad"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

window._firebaseDB = db;
window._firebaseFns = { collection, addDoc, setDoc, doc, getDocs, getDoc, updateDoc, deleteDoc };
</script>

<div id="creatorLabel">⭐️製作者：Y.Ninomiya</div>
<script src="main.js"></script>
</body>
</html>
